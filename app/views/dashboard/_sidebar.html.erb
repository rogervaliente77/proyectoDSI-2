<ul class="navbar-nav sidebar sidebar-dark accordion" id="accordionSidebar" style="background-color: #2C3E50;">

  <!-- Sidebar - Brand -->
  <% if @current_user.role.name.in?(["super_admin", "admin", "cajero"]) %>
    <a class="sidebar-brand d-flex align-items-center justify-content-center py-3" href="<%= admin_home_path %>" data-turbo="false">
      <div class="sidebar-brand-icon d-flex align-items-center justify-content-center" 
           style="width: 70px; height: 70px; background-color: #FFFFFF; border-radius: 50%; padding: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
        <img src="https://i.ibb.co/B2QsNGLm/20250913-1732-Logo-Herramientas-Ferre-Pro-remix-01k52pmwf5ewavwk0cjb9g6k1z-1.png"
             alt="Logo" class="img-fluid" style="max-width: 100%; max-height: 100%; object-fit: contain;">
      </div>
      <div class="sidebar-brand-text mx-2 text-white" style="font-size: 0.9rem;">Admin</div>
    </a>
  <% else %>
    <a class="sidebar-brand d-flex align-items-center justify-content-center py-3" href="<%= portal_home_path %>" data-turbo="false">
      <div class="sidebar-brand-icon d-flex align-items-center justify-content-center" 
           style="width: 70px; height: 70px; background-color: #FFFFFF; border-radius: 50%; padding: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
        <img src="https://i.ibb.co/B2QsNGLm/20250913-1732-Logo-Herramientas-Ferre-Pro-remix-01k52pmwf5ewavwk0cjb9g6k1z-1.png"
             alt="Logo" class="img-fluid" style="max-width: 100%; max-height: 100%; object-fit: contain;">
      </div>
      <div class="sidebar-brand-text mx-2 text-white" style="font-size: 0.9rem;">Portal de cliente</div>
    </a>
  <% end %>

  <hr class="sidebar-divider my-0">

  <!-- Dashboard -->
  <li class="nav-item active">
    <% if @current_user.role.name.in?(["super_admin", "admin", "cajero"]) %>
      <%= link_to admin_home_path, data: { turbo: false }, class: "nav-link" do %>
        <i class="fas fa-fw fa-tachometer-alt"></i>
        <span>Dashboard</span>
      <% end %>
    <% else %>
      <%= link_to portal_home_path, data: { turbo: false }, class: "nav-link" do %>
        <i class="fas fa-fw fa-tachometer-alt"></i>
        <span>Dashboard</span>
      <% end %>
    <% end %>
  </li>

  <hr class="sidebar-divider">

  <div class="sidebar-heading text-light">Interface</div>

  <!-- Settings -->
  <li class="nav-item">
    <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseSettings"
       aria-expanded="true" aria-controls="collapseSettings">
      <i class="fas fa-fw fa-cog"></i>
      <span>Settings</span>
    </a>
    <div id="collapseSettings" class="collapse" data-parent="#accordionSidebar">
      <div class="bg-white py-2 collapse-inner rounded">
        <h6 class="collapse-header">Cuenta:</h6>
        <% if @current_user.role.name.in?(["super_admin", "admin", "cajero"]) %>
          <a class="collapse-item" href="<%= admin_users_edit_password_path(id: @current_user.id) %>" data-turbo="false">Cambiar contraseña</a>
        <% else %>
          <a class="collapse-item" href="<%= portal_users_edit_password_path(id: @current_user.id) %>" data-turbo="false">Cambiar contraseña</a>
          <a class="collapse-item" href="<%= portal_profile_path(id: @current_user.id) %>" data-turbo="false">Editar Perfil</a>
        <% end %>
       <% if @current_user.role.name == "super_admin" %>
        <div class="dropdown-divider"></div>
        <h6 class="collapse-header">Configuraciones del sitio:</h6>
        <a class="collapse-item" href="<%= admin_site_configuration_path %>" data-turbo="false">Configuración general</a>
        <a class="collapse-item" href="<%= admin_update_site_configuration_path %>" data-turbo="false">Notificaciones y ofertas</a>
        <a class="collapse-item" href="<%= admin_mass_mail_path %>" data-turbo="false">Correos masivos</a>
      <% end %>
      </div>
    </div>
  </li>

  <% if @current_user.role.name.in?(["super_admin", "admin"]) %>
    <!-- Productos -->
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseProductos"
        aria-expanded="true" aria-controls="collapseProductos">
        <i class="fas fa-fw fa-folder"></i>
        <span>Productos</span>
      </a>
      <div id="collapseProductos" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Productos:</h6>
          <a class="collapse-item" href="<%= admin_productos_path %>" data-turbo="false">Productos</a>
          <a class="collapse-item" href="<%= admin_productos_new_path %>" data-turbo="false">Crear nuevo producto</a>
          <a class="collapse-item" href="<%= admin_categories_path %>" data-turbo="false">Categorias</a>
          <a class="collapse-item" href="<%= admin_inventory_admin_products_path %>" data-turbo="false">Inventario</a>
          <a class="collapse-item" href="<%= admin_product_histories_path %>" data-turbo="false">Movimientos de Inventario</a>
        </div>
      </div>
    </li>

    <!-- Marcas -->
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseMarcas"
         aria-expanded="true" aria-controls="collapseMarcas">
        <i class="fas fa-tags"></i>
        <span>Marcas</span>
      </a>
      <div id="collapseMarcas" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Gestión de Marcas:</h6>
          <a class="collapse-item" href="<%= admin_marcas_path %>" data-turbo="false">Ver Marcas</a>
          <a class="collapse-item" href="<%= new_admin_marca_path %>" data-turbo="false">Crear Nueva Marca</a>
        </div>
      </div>
    </li>
  <% end %>

  <!-- Usuarios -->
  <% if @current_user.role.name == "super_admin" %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUsers"
         aria-expanded="true" aria-controls="collapseUsers">
        <i class="fas fa-users"></i>
        <span>Users</span>
      </a>
      <div id="collapseUsers" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Usuarios:</h6>
          <a class="collapse-item" href="<%= admin_users_path %>" data-turbo="false">Usuarios</a>
          <a class="collapse-item" href="<%= new_admin_user_path %>" data-turbo="false">Crear nuevo usuario</a>
          <a class="collapse-item" href="<%= admin_roles_path %>" data-turbo="false">Roles</a>                
        </div>
      </div>
    </li>
  <% end %>

  <!-- Cajas -->
  <% if @current_user.role.name.in?(["super_admin", "admin"]) %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseCajas"
         aria-expanded="true" aria-controls="collapseCajas">
        <i class="fas fa-store"></i>
        <span>Cajas</span>
      </a>
      <div id="collapseCajas" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Cajas:</h6>
          <a class="collapse-item" href="<%= admin_cajas_path %>" data-turbo="false">Cajas</a>
          <a class="collapse-item" href="<%= admin_cajas_new_path %>" data-turbo="false">Crear nueva caja</a>
        </div>
      </div>
    </li>

    <!-- Cajeros -->
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseCajeros"
         aria-expanded="true" aria-controls="collapseCajeros">
        <i class="fas fa-user-tie"></i>
        <span>Cajeros</span>
      </a>
      <div id="collapseCajeros" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Cajeros:</h6>
          <a class="collapse-item" href="<%= admin_cajeros_path %>" data-turbo="false">Cajeros</a>
          <a class="collapse-item" href="<%= admin_cajeros_new_path %>" data-turbo="false">Crear nuevo cajero</a>
        </div>
      </div>
    </li>
  <% end %>

  <!-- Ventas -->
  <% if @current_user.role.name.in?(["super_admin", "admin", "cajero"]) %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseSales"
         aria-expanded="true" aria-controls="collapseSales">
        <i class="fas fa-shopping-cart"></i>
        <span>Ventas</span>
      </a>
      <div id="collapseSales" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Ventas:</h6>
          <a class="collapse-item" href="<%= admin_sales_path %>" data-turbo="false">Ventas</a>
          <a class="collapse-item" href="<%= admin_sales_new_path %>" data-turbo="false">Crear nueva venta</a>
          <% if @current_user.role.name != "cajero" %>
            <a class="collapse-item" href="<%= admin_discount_codes_path %>" data-turbo="false">Codigos de descuento</a>
          <% end %>
        </div>
      </div>
    </li>
  <% end %>

  <!-- Reportes -->
  <% if @current_user.role.name.in?(["super_admin", "admin", "cajero"]) %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseReports"
         aria-expanded="true" aria-controls="collapseReports">
        <i class="fas fa-chart-bar"></i>
        <span>Reportes</span>
      </a>
      <div id="collapseReports" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Gestión de Reportes:</h6>
          <a class="collapse-item" href="/admin/reports">Lista de reportes</a>
          <% if @current_user.role.name.in?(["super_admin", "admin"]) %>
            <a class="collapse-item" href="/admin/reports/top_products">Producto Más Vendido</a>
            <a class="collapse-item" href="/admin/reports/top_brands">Marca Más Vendida</a>
          <% end %>
          <a class="collapse-item" href="/admin/reports/best_seller">Mejor Vendedor</a>
        </div>
      </div>
    </li>
  <% end %>

  <!-- Mis compras - Cliente -->
  <% if @current_user.role.name == 'cliente' %>
    <li class="nav-item">
      <%= link_to portal_purchases_path,
          class: "nav-link d-flex align-items-center",
          data: { turbo: false } do %>
        <i class="fas fa-shopping-bag me-2"></i>
        Mis compras
      <% end %>
    </li>
  <% end %>

  <!-- Devoluciones -->
  <% if @current_user.role.name.in?(["super_admin", "admin", "cajero"]) %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseDevoluciones"
         aria-expanded="true" aria-controls="collapseDevoluciones">
        <i class="fas fa-undo-alt"></i>
        <span>Devoluciones</span>
      </a>
      <div id="collapseDevoluciones" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Gestión de Devoluciones:</h6>
          <a class="collapse-item" href="<%= admin_devoluciones_path %>" data-turbo="false">Ver Devoluciones</a>
          <a class="collapse-item" href="<%= new_admin_devolucione_path %>" data-turbo="false">Crear Nueva Devolución</a>
          <% if @current_user.role.name != "cajero" %>
            <a class="collapse-item" href="<%= admin_admin_returned_products_path %>" data-turbo="false">Productos devueltos</a>
          <% end %>
        </div>
      </div>
    </li>
  <% end %>

  <!-- Mensajeros -->
  <% if @current_user.role.name.in?(["super_admin", "admin"]) %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseMensajeros"
         aria-expanded="true" aria-controls="collapseMensajeros">
        <i class="fas fa-motorcycle"></i>
        <span>Mensajeros</span>
      </a>
      <div id="collapseMensajeros" class="collapse" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Gestión de mensajeros:</h6>
          <a class="collapse-item" href="<%= admin_delivery_drivers_path %>" data-turbo="false">Ver mensajeros</a>
          <a class="collapse-item" href="<%= new_admin_delivery_driver_path %>" data-turbo="false">Crear nuevo mensajero</a>
        </div>
      </div>
    </li>
  <% end %>

  <% if @current_user.role.name.in?(["super_admin", "admin"]) %>
    <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapsePedidos"
         aria-expanded="true" aria-controls="collapsePedidos">
        <i class="fas fa-truck"></i>
        <span>Pedidos</span>
      </a>
      <div id="collapsePedidos" class="collapse" aria-labelledby="headingPedidos" data-parent="#accordionSidebar">
        <div class="bg-white py-2 collapse-inner rounded">
          <h6 class="collapse-header">Pedidos</h6>
          <a class="collapse-item" href="<%= admin_pedidos_path %>" data-turbo="false">
            Todos los pedidos
          </a>

          <a class="collapse-item" href="<%= admin_pedidos_path(delivery_status: 'unassigned') %>" data-turbo="false">
            Pedidos no asignados
          </a>

          <a class="collapse-item" href="<%= admin_pedidos_path(delivery_status: 'in_route') %>" data-turbo="false">
            Pedidos en ruta
          </a>

          <a class="collapse-item" href="<%= admin_pedidos_path(delivery_status: 'delivered') %>" data-turbo="false">
            Pedidos entregados
          </a>
        </div>
      </div>
    </li>
  <% end %>

  <% if @current_user.role.name == 'mensajero' %>
    <li class="nav-item">
      <%= link_to admin_pedidos_path, class: "nav-link d-flex align-items-center" do %>
        <i class="fas fa-truck"></i>
        Pedidos asignados
      <% end %>
    </li>
  <% end %>


  <hr class="sidebar-divider d-none d-md-block">
  <div class="text-center d-none d-md-inline">
    <button class="rounded-circle border-0" id="sidebarToggle"></button>
  </div>

</ul>
